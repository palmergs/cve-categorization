require 'cve_file_parser'
namespace :cve do
  desc "load a collection of CVEs from file"
  task :import, [:path] => [:environment] do |t, args|
    path = args[:path]
    abort("File not found :: #{ path }") unless File.readable?(path)
    p "Parsing :: #{ path }"
    parser = CveFileParser.new(path)
    parser.parse
    p "Complete :: #{ Vulnerability.count } CVEs in database"
  end
end
