require 'cve_handler'

class CveFileParser 

  attr_reader :path

  def initialize path
    raise ArgumentError.new("File #{ path } does not exist") unless File.exist?(path)
    @path = path 
  end

  def parse
    handler = CveHandler.new
    File.open(path) do |f|
      parser = Oga::XML::SaxParser.new(handler, f)
      parser.parse
    end
  end

end
