import Ember from 'ember';

export default Ember.Component.extend({
  tagName: 'tr',

  editName: '',
  doubleClicked: false,

  isEditing: Ember.computed('model', function() {
    return !this.get('model') || this.get('doubleClicked');
  }),

  newModel(name) {
    this.set('editName', null);
    this.sendAction('technologyAdded', name);
    this.$('.input').blur();
  },

  updateModel(name) {
    const model = this.get('model');
    model.set('name', name);
    model.save().then(() => {
      // TODO: handle successful result
      this.set('editName', null);
    }, () => {
      // TODO: handle error result
    });
  },


  actions: {
    nameEntered(val) {
      this.set('doubleClicked', false);
      if(!Ember.isEmpty(val)) {
        if(this.get('model')) {
          this.updateModel(val);
        } else {
          this.newModel(val);
        }
      }
    }
  }
});
