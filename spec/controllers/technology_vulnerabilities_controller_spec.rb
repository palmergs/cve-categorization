require 'rails_helper'

RSpec.describe TechnologyVulnerabilitiesController, type: :controller do

  describe '#index' do
    it 'can query for technology vulnerabilities' do
      get :index, format: :json
      expect(response).to be_success
    end
  end

  describe '#show' do
    it 'can return a tech vulnerability' do
      tv = create(:technology_vulnerability)
      get :show, format: :json, params: { id: tv.id }
      expect(response).to be_success
    end
  end

  describe '#create' do
    it 'can create a tech vulnerability' do
      tech = create(:technology)
      vuln = create(:vulnerability)
      post :create, format: :json, params: { technology_vulnerability: { technology_id: tech.id, vulnerability_id: vuln.id } }
      expect(response).to be_success
    end
  end

  describe '#update' do
    it 'can update a tech vulnerability' do
      tv = create(:technology_vulnerability)
      put :update, format: :json, params: { id: tv.id, technology_vulnerability: { user_indicator: 3 } }
      expect(response).to be_success
    end
  end

  describe '#destroy' do
    it 'can destroy a tech vulnerability' do
      tv = create(:technology_vulnerability)
      delete :destroy, format: :json, params: { id: tv.id }
      expect(response).to be_success
    end
  end

end
