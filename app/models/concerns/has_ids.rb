module Concerns
  module HasIds
    extend ActiveSupport::Concern

    included do
      scope :by_ids, ->(ids) {
        if ids
          arr = Array(ids).map(&:to_i).compact
          if arr
            where(id: arr)
          else
            where('1=0')
          end
        end
      }
    end

    class_methods do
      def normalize_query str
        tmp = str.to_s.gsub(/[%_]/, '')
        tmp.strip.empty? ? nil : tmp.strip
      end
    end
  end
end
