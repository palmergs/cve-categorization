class UserAssessment < ApplicationRecord
  belongs_to :assessment
  has_one :vulnerability, through: :assessment

  after_save do |ua|
    ass = ua.assessment
    ass.update_attributes({
      user_assessment_count: ass.user_assessment_count + 1,
      user_assessment_sum: ass.user_assessment_sum + ua.value })
  end

  before_destroy do |ua|
    ass = ua.assessment
    ass.update_attributes({
      user_assessment_count: ass.user_assessment_count - 1,
      user_assessment_sum: ass.user_assessment_sum - ua.value })
  end
end
