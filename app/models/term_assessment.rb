class TermAssessment < ApplicationRecord
  belongs_to :term
  belongs_to :assessment
  has_one :vulnerability, through: :assessment

  after_create do |ta|
    ass = ta.assessment
    ass.update_attributes({
      term_assessment_count: ass.term_assessment_count + 1,
      term_assessment_sum: ass.term_assessment_sum + ta.value })
  end

  before_destroy do |ta|
    ass = ta.assessment
    ass.update_attributes({
      term_assessment_count: ass.term_assessment_count - 1,
      term_assessment_sum: ass.term_assessment_sum - ta.value })
  end
end
