class Assessment < ApplicationRecord

  CATEGORIZED =    99
  USER_SELECTED =   2
  TERM_LIKELY =     1
  UNCATEGORIZED =   0
  TERM_UNLIKELY =  -1
  USER_REJECTED =  -2

  belongs_to :vulnerability
  belongs_to :technology

  has_many :term_assessments, dependent: :delete_all
  has_many :terms, through: :term_assessments

  has_many :user_assessments, dependent: :delete_all

  scope :by_vulnerability, ->(id) { where(vulnerability_id: Integer(id)) if id.present? }

  scope :by_technology, ->(id) { where(technology_id: Integer(id)) if id.present? }

  after_initialize do |obj|
    obj.user_assessment_count = 0
    obj.user_assessment_sum = 0
    obj.term_assessment_count = 0
    obj.term_assessment_sum = 0
  end
end
