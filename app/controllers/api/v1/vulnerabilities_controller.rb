class Api::V1::VulnerabilitiesController < ApplicationController
  include Concerns::HasPagination

  def index
    @vulnerabilities = Vulnerability.by_ids(params[:ids]).
        by_query(params[:q]).
        by_year(params[:year]).
        page(current_page).
        per(current_size).
        order(current_sort)
    render json: @vulnerabilities, meta: meta(@vulnerabilities)
  end

  def show
    @vulnerability = Vulnerability.find(params[:id])
    render json: @vulnerability
  end

  def available_cols
    hash = super
    hash[:cve] = [ :asc, :desc ]
    hash[:title] = [ :asc, :desc ]
    hash
  end
end
